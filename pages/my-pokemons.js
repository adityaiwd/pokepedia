import { useState, useEffect } from "react";
import Head from "next/head";
import { Title, TitleWrapper } from "../components/global/Global";
import PokemonCard from "../components/global/PokemonCard";
import { TwoColumnGrid } from "../components/global/Global";
import { db } from "../utils/db";
import Loader from "../components/global/Loader";
import pokemonImage from "../utils/pokemon-image";

export default function MyPokemons() {
  const [pokemons, setPokemons] = useState([]);
  useEffect(() => {
    db.myPokemons.toArray().then((pokemons) => {
      setPokemons(pokemons);
    });
  },[])

  return (
    <div>
      <Head>
        <title>Poképedia | My Pokémons</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <TitleWrapper>
        <Title>My Pokémons</Title>
      </TitleWrapper>
      {pokemons ? (
        <TwoColumnGrid>
          {pokemons.map((pokemon) => (
            <PokemonCard
              key={pokemon.id}
              id={pokemon.pokeId}
              image={pokemonImage(pokemon.pokeId)}
              name={pokemon.name}
              nickname={pokemon.nickname}
              disabledLink
            />
          ))}
        </TwoColumnGrid>
      ) : (
        <Loader />
      )}
    </div>
  );
}
